### Процес замены в файлах конфигурации Terraform имен инстансов

```ps
root@PC-Ubuntu:~/ansible-learning/yandex-cloud/Delta/terraform# grep -r 'node03'
node03.tf:resource "yandex_compute_instance" "node03" {
node03.tf:  name                      = "node03"
node03.tf:  hostname                  = "node03.netology.yc"
node03.tf:      name        = "root-node03"
inventory.tf:    node03.netology.yc ansible_host=${yandex_compute_instance.node03.network_interface.0.nat_ip_address}
inventory.tf:    yandex_compute_instance.node03,
output.tf:output "internal_ip_address_node03" {
output.tf:  value = "${yandex_compute_instance.node03.network_interface.0.ip_address}"
output.tf:output "external_ip_address_node03" {
output.tf:  value = "${yandex_compute_instance.node03.network_interface.0.nat_ip_address}"
```

```ps
root@PC-Ubuntu:~/ansible-learning/yandex-cloud/Delta/terraform# sed 's/node03/application-instance/g' inventory.tf | tee inventory.tf 
resource "local_file" "inventory" {
  content = <<-DOC
    # Ansible inventory containing variable values from Terraform.
    # Generated by Terraform.

    [nodes:children]
    managers
    workers

    [managers:children]
    active
    standby

    [active]
    el-instance.netology.yc ansible_host=${yandex_compute_instance.el-instance.network_interface.0.nat_ip_address}

    [standby]
    k-instance.netology.yc ansible_host=${yandex_compute_instance.k-instance.network_interface.0.nat_ip_address}
    application-instance.netology.yc ansible_host=${yandex_compute_instance.application-instance.network_interface.0.nat_ip_address}

    [workers]
    node04.netology.yc ansible_host=${yandex_compute_instance.node04.network_interface.0.nat_ip_address}
    node05.netology.yc ansible_host=${yandex_compute_instance.node05.network_interface.0.nat_ip_address}
    node06.netology.yc ansible_host=${yandex_compute_instance.node06.network_interface.0.nat_ip_address}
    DOC
  filename = "../ansible/inventory"

  depends_on = [
    yandex_compute_instance.el-instance,
    yandex_compute_instance.k-instance,
    yandex_compute_instance.application-instance,
    yandex_compute_instance.node04,
    yandex_compute_instance.node05,
    yandex_compute_instance.node06
  ]
}
```

```ps
root@PC-Ubuntu:~/ansible-learning/yandex-cloud/Delta/terraform# sed 's/node03/application-instance/g' output.tf | tee output.tf 
output "internal_ip_address_el-instance" {
  value = "${yandex_compute_instance.el-instance.network_interface.0.ip_address}"
}

output "external_ip_address_el-instance" {
  value = "${yandex_compute_instance.el-instance.network_interface.0.nat_ip_address}"
}

output "internal_ip_address_k-instance" {
  value = "${yandex_compute_instance.k-instance.network_interface.0.ip_address}"
}

output "external_ip_address_k-instance" {
  value = "${yandex_compute_instance.k-instance.network_interface.0.nat_ip_address}"
}

output "internal_ip_address_application-instance" {
  value = "${yandex_compute_instance.application-instance.network_interface.0.ip_address}"
}

output "external_ip_address_application-instance" {
  value = "${yandex_compute_instance.application-instance.network_interface.0.nat_ip_address}"
}

output "internal_ip_address_node04" {
  value = "${yandex_compute_instance.node04.network_interface.0.ip_address}"
}

output "external_ip_address_node04" {
  value = "${yandex_compute_instance.node04.network_interface.0.nat_ip_address}"
}

output "internal_ip_address_node05" {
  value = "${yandex_compute_instance.node05.network_interface.0.ip_address}"
}

output "external_ip_address_node05" {
  value = "${yandex_compute_instance.node05.network_interface.0.nat_ip_address}"
}

output "internal_ip_address_node06" {
  value = "${yandex_compute_instance.node06.network_interface.0.ip_address}"
}

output "external_ip_address_node06" {
  value = "${yandex_compute_instance.node06.network_interface.0.nat_ip_address}"
}
```

```ps
root@PC-Ubuntu:~/ansible-learning/yandex-cloud/Delta/terraform# sed 's/node03/application-instance/g' node03.tf | tee node03.tf 
resource "yandex_compute_instance" "application-instance" {
  name                      = "application-instance"
  zone                      = "ru-central1-a"
  hostname                  = "application-instance.netology.yc"
  allow_stopping_for_update = true

  resources {
    cores  = 4
    memory = 8
  }

  boot_disk {
    initialize_params {
      image_id    = "${var.centos-7-base}"
      name        = "root-application-instance"
      type        = "network-nvme"
      size        = "10"
    }
  }

  network_interface {
    subnet_id  = "${yandex_vpc_subnet.default.id}"
    nat        = true
    ip_address = "192.168.101.13"
  }

  metadata = {
    ssh-keys = "centos:${file("~/.ssh/id_rsa.pub")}"
  }
}
```

```ps

root@PC-Ubuntu:~/ansible-learning/yandex-cloud/Delta/terraform# ls -l
итого 48
-rw-r--r-- 1 root root 1273 фев 19 08:54 inventory.tf
-rw------- 1 root root 2402 дек 10 18:10 key.json
-rw-r--r-- 1 root root  260 дек 11 09:03 network.tf
-rw-r--r-- 1 root root  681 фев 19 08:39 node01.tf
-rw-r--r-- 1 root root  677 фев 19 08:50 node02.tf
-rw-r--r-- 1 root root  717 фев 19 08:55 node03.tf
-rw-r--r-- 1 root root  661 дек 11 09:03 node04.tf
-rw-r--r-- 1 root root  661 дек 11 09:03 node05.tf
-rw-r--r-- 1 root root  661 дек 11 09:03 node06.tf
-rw-r--r-- 1 root root 1531 фев 19 08:54 output.tf
-rw-r--r-- 1 root root  252 дек 11 09:03 provider.tf
-rw-r--r-- 1 root root  668 фев 19 07:08 variables.tf
```

```ps
root@PC-Ubuntu:~/ansible-learning/yandex-cloud/Delta/terraform# mv node01.tf el-instance.tf
```

```ps
root@PC-Ubuntu:~/ansible-learning/yandex-cloud/Delta/terraform# mv node02.tf k-instance.tf
```

```ps
root@PC-Ubuntu:~/ansible-learning/yandex-cloud/Delta/terraform# mv node03.tf application-instance.tf
```

```ps
root@PC-Ubuntu:~/ansible-learning/yandex-cloud/Delta/terraform# ls -l
итого 48
-rw-r--r-- 1 root root  717 фев 19 08:55 application-instance.tf
-rw-r--r-- 1 root root  681 фев 19 08:39 el-instance.tf
-rw-r--r-- 1 root root 1273 фев 19 08:54 inventory.tf
-rw------- 1 root root 2402 дек 10 18:10 key.json
-rw-r--r-- 1 root root  677 фев 19 08:50 k-instance.tf
-rw-r--r-- 1 root root  260 дек 11 09:03 network.tf
-rw-r--r-- 1 root root  661 дек 11 09:03 node04.tf
-rw-r--r-- 1 root root  661 дек 11 09:03 node05.tf
-rw-r--r-- 1 root root  661 дек 11 09:03 node06.tf
-rw-r--r-- 1 root root 1531 фев 19 08:54 output.tf
-rw-r--r-- 1 root root  252 дек 11 09:03 provider.tf
-rw-r--r-- 1 root root  668 фев 19 07:08 variables.tf


```
