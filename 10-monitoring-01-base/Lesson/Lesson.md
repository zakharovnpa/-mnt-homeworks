# Ход выполнения Домашнего задания к занятию "10.01. Зачем и что нужно мониторить"

## Обязательные задания     - 01:17:00

1. Вас пригласили настроить мониторинг на проект. На онбординге вам рассказали, что проект представляет из себя 
платформу для вычислений с выдачей текстовых отчетов, которые сохраняются на диск. Взаимодействие с платформой 
осуществляется по протоколу http. Также вам отметили, что вычисления загружают ЦПУ. Какой минимальный набор метрик вы
выведите в мониторинг и почему?

Андрюнин: чем больше напишем метрик, тем лучше

**Ответ:**

Вероятно, что на платформе существует низкопроизводительный компонент, который создает "бутылочное горлышко" при вычислениях.
Это может быть недостаточный размер RAM (при этом будет идти активный свопинг), слабый CPU (при этом его загрузка будет близка к 100%).
Также причина может быть в образовании большого количества текстовых файлов (отчетов) и образования ошибок при передаче их по сети.
Менее вероятно, что недостаточно свободного места на HDD (при этом ОС может приостанавливать процессы, участвующме в вычислениях). Поэтому для определения
причины высокой загрузки CPU необходимо включить в мониторинг следующие метрики:

* Згрузка RAM
* Згрузка CPU
* Размер SWAP
* HDD - производительность при
* OS - очередь на передачу данных
* Ошибки сети
 



2. Менеджер продукта посмотрев на ваши метрики сказал, что ему непонятно что такое RAM/inodes/CPUla. Также он сказал, 
что хочет понимать, насколько мы выполняем свои обязанности перед клиентами и какое качество обслуживания. Что вы 
можете ему предложить?

Андрюнин: это про SLO, SLA, SLI
Почитать статью [Управление инцидентами SLA, SLO и SLI: в чем разница?](https://www.atlassian.com/ru/incident-management/kpis/sla-vs-slo-vs-sli)

**Ответ:**



3. Вашей DevOps команде в этом году не выделили финансирование на построение системы сбора логов. Разработчики в свою 
очередь хотят видеть все ошибки, которые выдают их приложения. Какое решение вы можете предпринять в этой ситуации, 
чтобы разработчики получали ошибки приложения?

**Ответ:**

Андрюнин: придумайте ситуацию

Sentry
New Relic 
Data Dog - облачное решение, где хранятся логи
Syslog + Grep

Основные метрики для мониторинга в системах
сбора логов и ловли ошибок:
- Good events/All events
- Trafﬁc



3. Вы, как опытный SRE, сделали мониторинг, куда вывели отображения выполнения SLA=99% по http кодам ответов. 
Вычисляете этот параметр по следующей формуле: summ_2xx_requests/summ_all_requests. Данный параметр не поднимается выше 
70%, но при этом в вашей системе нет кодов ответа 5xx и 4xx. Где у вас ошибка?

**Ответ:**

Пример SLO:
В 99% случаев мы должны отдавать http коды отличный от 4xx/5xx. 1%
выделяется на техническое обслуживание.
Расчет SLI может выглядеть таким образом:
SLI = (summ_2xx_requests + summ_3xx_requests)/(summ_all_requests)



## Дополнительное задание (со звездочкой*) - необязательно к выполнению

Написать наPython, или [Prometeus + PushGateway + curl](https://prometheus.io/docs/practices/pushing/) [Пример](https://github.com/prometheus/pushgateway#command-line)

или Grep

или Zabbix Agent


Вы устроились на работу в стартап. На данный момент у вас нет возможности развернуть полноценную систему 
мониторинга, и вы решили самостоятельно написать простой python3-скрипт для сбора основных метрик сервера. Вы, как 
опытный системный-администратор, знаете, что системная информация сервера лежит в директории `/proc`. 
Также, вы знаете, что в системе Linux есть  планировщик задач cron, который может запускать задачи по расписанию.

Суммировав все, вы спроектировали приложение, которое:
- является python3 скриптом
- собирает метрики из папки `/proc`
- складывает метрики в файл 'YY-MM-DD-awesome-monitoring.log' в директорию /var/log 
(YY - год, MM - месяц, DD - день)
- каждый сбор метрик складывается в виде json-строки, в виде:
  + timestamp (временная метка, int, unixtimestamp)
  + metric_1 (метрика 1)
  + metric_2 (метрика 2)
  
     ...
     
  + metric_N (метрика N)
  
- сбор метрик происходит каждую 1 минуту по cron-расписанию

Для успешного выполнения задания нужно привести:

а) работающий код python3-скрипта,

б) конфигурацию cron-расписания,

в) пример верно сформированного 'YY-MM-DD-awesome-monitoring.log', имеющий не менее 5 записей,

P.S.: количество собираемых метрик должно быть не менее 4-х.
P.P.S.: по желанию можно себя не ограничивать только сбором метрик из `/proc`.

---

### Как оформить ДЗ?

Выполненное домашнее задание пришлите ссылкой на .md-файл в вашем репозитории.

---
